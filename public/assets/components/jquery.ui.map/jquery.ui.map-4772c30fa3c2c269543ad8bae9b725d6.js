/*!
 * jQuery FN Google Map 3.0-rc
 * http://code.google.com/p/jquery-ui-map/
 * Copyright (c) 2010 - 2012 Johan SÃ¤ll Larsson
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
(function(e){e.a=function(t,n){var r=t.split(".")[0];t=t.split(".")[1],e[r]=e[r]||{},e[r][t]=function(e,t){arguments.length&&this._setup(e,t)},e[r][t].prototype=e.extend({namespace:r,pluginName:t},n),e.fn[t]=function(n){var i=typeof n=="string",s=Array.prototype.slice.call(arguments,1),o=this;return i&&n.substring(0,1)==="_"?o:(this.each(function(){var u=e.data(this,t);u||(u=e.data(this,t,new e[r][t](n,this))),i&&(o=u[n].apply(u,s))}),o)}},e.a("ui.gmap",{options:{mapTypeId:"roadmap",zoom:5},option:function(e,t){return t?(this.options[e]=t,this.get("map").set(e,t),this):this.options[e]},_setup:function(e,t){this.el=t,e=e||{},jQuery.extend(this.options,e,{center:this._latLng(e.center)}),this._create(),this._init&&this._init()},_create:function(){var t=this;this.instance={map:new google.maps.Map(t.el,t.options),markers:[],overlays:[],services:[]},google.maps.event.addListenerOnce(t.instance.map,"bounds_changed",function(){e(t.el).trigger("init",t.instance.map)}),t._call(t.options.callback,t.instance.map)},addBounds:function(e){var t=this.get("bounds",new google.maps.LatLngBounds);return t.extend(this._latLng(e)),this.get("map").fitBounds(t),this},inViewport:function(e){var t=this.get("map").getBounds();return t?t.contains(e.getPosition()):!1},addControl:function(e,t){return this.get("map").controls[t].push(this._unwrap(e)),this},addMarker:function(t,n){t.map=this.get("map"),t.position=this._latLng(t.position);var r=new(t.marker||google.maps.Marker)(t),i=this.get("markers");return r.id?i[r.id]=r:i.push(r),r.bounds&&this.addBounds(r.getPosition()),this._call(n,t.map,r),e(r)},clear:function(e){return this._c(this.get(e)),this.set(e,[]),this},_c:function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]instanceof google.maps.MVCObject?(google.maps.event.clearInstanceListeners(e[t]),e[t].setMap&&e[t].setMap(null)):e[t]instanceof Array&&this._c(e[t]),e[t]=null)},find:function(t,n,r){var i=this.get(t);n.value=e.isArray(n.value)?n.value:[n.value];for(var s in i)if(i.hasOwnProperty(s)){var o=!1;for(var u in n.value)if(e.inArray(n.value[u],i[s][n.property])>-1)o=!0;else if(n.operator&&n.operator==="AND"){o=!1;break}r(i[s],o)}return this},get:function(e,t){var n=this.instance;if(!n[e]){if(e.indexOf(">")>-1){var r=e.replace(/ /g,"").split(">");for(var i=0;i<r.length;i++){if(!n[r[i]]){if(!t)return null;n[r[i]]=i+1<r.length?[]:t}n=n[r[i]]}return n}t&&!n[e]&&this.set(e,t)}return n[e]},openInfoWindow:function(e,t,n){var r=this.get("iw",e.infoWindow||new google.maps.InfoWindow);return r.setOptions(e),r.open(this.get("map"),this._unwrap(t)),this._call(n,r),this},closeInfoWindow:function(){return this.get("iw")!=null&&this.get("iw").close(),this},set:function(e,t){return this.instance[e]=t,this},refresh:function(){var t=this.get("map"),n=t.getCenter();return e(t).triggerEvent("resize"),t.setCenter(n),this},destroy:function(){this.clear("markers").clear("services").clear("overlays")._c(this.instance),jQuery.removeData(this.el,this.name)},_call:function(t){t&&e.isFunction(t)&&t.apply(this,Array.prototype.slice.call(arguments,1))},_latLng:function(e){return e?e instanceof google.maps.LatLng?e:(e=e.replace(/ /g,"").split(","),new google.maps.LatLng(e[0],e[1])):new google.maps.LatLng(0,0)},_unwrap:function(t){return t?t instanceof jQuery?t[0]:t instanceof Object?t:e("#"+t)[0]:null}}),jQuery.fn.extend({triggerEvent:function(e){return google.maps.event.trigger(this[0],e),this},addEventListener:function(e,t,n){return google.maps&&this[0]instanceof google.maps.MVCObject?google.maps.event.addListener(this[0],e,t):n?this.bind(e,t,n):this.bind(e,t),this}}),jQuery.each("click rightclick dblclick mouseover mouseout drag dragend".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return this.addEventListener(t,e,n)}})})(jQuery);