(function(){$.fn.jflickrfeed=function(e,t){e=$.extend(!0,{flickrbase:"http://api.flickr.com/services/feeds/",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:!0,useTemplate:!0,itemTemplate:"",itemCallback:function(){}},e);var n=e.flickrbase+e.feedapi+"?",r=!0;for(var i in e.qstrings)r||(n+="&"),n+=i+"="+e.qstrings[i],r=!1;return $(this).each(function(){var r=$(this),i=this;$.getJSON(n,function(n){$.each(n.items,function(t,n){if(t<e.limit){if(e.cleanDescription){var s=/<p>(.*?)<\/p>/g,o=n.description;s.test(o)&&(n.description=o.match(s)[2],n.description!=undefined&&(n.description=n.description.replace("<p>","").replace("</p>","")))}n.image_s=n.media.m.replace("_m","_s"),n.image_t=n.media.m.replace("_m","_t"),n.image_m=n.media.m.replace("_m","_m"),n.image=n.media.m.replace("_m",""),n.image_b=n.media.m.replace("_m","_b"),delete n.media;if(e.useTemplate){var u=e.itemTemplate;for(var a in n){var f=new RegExp("{{"+a+"}}","g");u=u.replace(f,n[a])}r.append(u)}e.itemCallback.call(i,n)}}),$.isFunction(t)&&t.call(i,n)})})}})();