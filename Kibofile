# This is an example Kibofile. Use with kibo(1) to configure
# remote instances.
heroku:
  # The email of the heroku account to create app instances on heroku.
  account: deployment@bountyhill.com

  # Our instances will be called 'bountyhill-staging-web0', 'bountyhill-production-worker0', etc.
  namespace: bountyhill

# What to do before, during and after deploymet? These steps are run in the order 
# of their keys
deployment:
  pre:
    - git rm -r --force --quiet public/assets || true
    - rake assets:rebuild
    - kibo compress --quiet public/assets
    - git add -f public/assets
    - git commit -m '[kibo] Updated assets'
  success:
    - heroku run rake db:migrate
source:
  pre:
    - rm -rf tmp/assets
    - mv public/assets tmp/assets || true
  success:
    - git tag $ENVIRONMENT-$(date "+%Y.%m.%d-%H.%M")
  final:
    - rm -rf public/assets
    - mv tmp/assets public/assets || true
defaults:
  web: 1
