<%= form_for(identity, :url => "/auth/google/init") do |form| %>
  <% if current_user %>
    <p><%= I18n.t("identity/google.form.new.legend") %></p>
  <% else %>
    <p><%= I18n.t("identity/google.form.signin.legend") %></p>
  <% end %>

  <%= form.error_messages @error if @error %>
  <%#= hidden_field_tag :req, :google %>

  <%= form.control_group :commercial, :check_box %>

  <% if current_user && !identity_requested?(:google) %>
    <%= form.actions "#", :"data-dismiss" => "modal" %>
  <% else %>
    <% unless current_user %>
      <p><%= I18n.t("identity.form.agree_to_terms")%></p>
      <%= form.agree_to_terms(:id => "agree_to_terms_google") %>
    <% end %>
    
    <div class="buttons">
      <%= link_to_cancel_signin %>
      <%= form.submit I18n.t("button.signin"),
        :name => "signin_google",
        :id => "signin_google",
        :class => "btn btn-primary btn-inverse",
        :disabled => "disabled" %>
    </div>
  <% end %>
<% end %>

<script type="text/javascript" charset="utf-8">
  $("#agree_to_terms_google").change(function() {
    if($(this).is(':checked'))
      $("#signin_google").removeAttr("disabled");
    else
      $("#signin_google").attr("disabled", "disabled");
  });
</script>