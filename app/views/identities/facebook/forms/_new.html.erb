<%= form_for(identity, :url => "/auth/facebook/init") do |form| %>
  <% if current_user %>
    <p><%= I18n.t("identity/facebook.form.create.legend") %></p>
  <% else %>
    <p><%= I18n.t("identity/facebook.form.signin.legend") %></p>
  <% end %>

  <%= hidden_field_tag :req, params[:req] %>
  <%= form.error_messages @error if @error %>

  <% if current_user %>
    <%= form.actions "#", :"data-dismiss" => "modal" %>
  <% else %>
    <div class="checkbox-group">
      <%= form.agree_to_terms(:id => "agree_to_terms_facebook") unless current_user%>
    </div>
    <div class="buttons">
      <%= link_to_cancel_signin %>
      <%= form.submit I18n.t("button.signin"), :name => "signin_facebook", :id => "signin_facebook", :class => "btn btn-primary btn-inverse", :disabled => "disabled" %>
    </div>
  <% end %>
<% end %>

<script type="text/javascript" charset="utf-8">
  $("#agree_to_terms_facebook").change(function() {
    if($(this).is(':checked'))
      $("#signin_facebook").removeAttr("disabled");
    else
      $("#signin_facebook").attr("disabled", "disabled");
  });
</script>